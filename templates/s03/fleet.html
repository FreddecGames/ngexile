{% extends "s03/layout.html" %}
{% load humanize %}
{% block content %}
<div class="page-content">
    {% if idle %}
        <script>
        function confirmAbandon() { return confirm('Êtes-vous sûr de vouloir abandonner la flotte "{{ fleetname }}" ?\r\nLes vaisseaux seront endommagés de telle sorte qu\'ils ne pourront être réutilisés !'); }
        </script>
        <div id="renamebox" class="hidden">
            <form action="?id={{ fleetid }}" method="post" class="row gx-2">
                {% csrf_token %}
                <input type='hidden' name='action' value='rename'>
                <div class="col">
                    <input type='text'
                           class="form-control"
                           name='newname'
                           value='{{ fleetname }}'>
                </div>
                <div class="col-auto">
                    <input type="submit" class="btn btn-primary" value='OK'>
                </div>
                <div class="col-auto">
                    <button type="button" onclick="hide();" class="btn btn-danger">
                        <i class="fa-fw fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
            </form>
        </div>
    {% endif %}
    <div class="row gx-3">
        <div class="col-8">
            <div class="card">
                <div id="renameref" class="card-header">
                    <div class="row gx-3 align-items-baseline">
                        <div class="col">
                            <span class="fs-6">{{ fleetname }}</span>
                        </div>
                        {% if idle %}
                            <div class="col-auto">
                                <a href="#" onclick="return show('renameref','renamebox')">Renommer</a>
                            </div>
                            <div class="col-auto">
                                <a href="?planet={{ planetid }}&id={{ fleetid }}&action=abandon"
                                   onclick="return confirmAbandon()">Abandonner</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                <div class="row g-2 flex-column">
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Action</span>
                            </div>
                            <div class="col-9">
                                <div class="row gx-3 align-items-center">
                                    <div class="col">
                                        <div class="row gx-3 align-items-center">
                                            {% if recycling %}
                                                <div class="col-auto">
                                                    <span class="text-success">En recyclage</span>
                                                </div>
                                                <div class="col">
                                                    <script>putplanet("{{planetid}}","{{planetname}}","{{g}}","{{s}}","{{p}}",{{relation}});</script>
                                                </div>
                                                <div class="col-auto">
                                                    <span class="text-yellow"><script>putcountdown1({{time}}, 'Cycle terminé', '?id={{fleetid}}')</script></span>
                                                </div>
                                            {% endif %}
                                            {% if patrolling %}
                                                <div class="col-auto">
                                                    <span class="text-normal">En patrouille</span>
                                                </div>
                                                <div class="col">
                                                    <script>putplanet("{{planetid}}","{{planetname}}","{{g}}","{{s}}","{{p}}",{{relation}});</script>
                                                </div>
                                            {% endif %}
                                            {% if fighting %}
                                                <div class="col-auto">
                                                    <span class="text-danger">En combat</span>
                                                </div>
                                                <div class="col">
                                                    <script>putplanet("{{planetid}}","{{planetname}}","{{g}}","{{s}}","{{p}}",{{relation}});</script>
                                                </div>
                                            {% endif %}
                                            {% if moving %}
                                                <div class="col-auto">
                                                    <span class="text-success">En transit</span>
                                                </div>
                                                <div class="col">
                                                    <script>putplanet("{{planetid}}","{{planetname}}","{{g}}","{{s}}","{{p}}",{{relation}});</script>
                                                    <small class="mx-1 text-normal"><i class="fa-fw fas fa-long-arrow-alt-right"></i></small>
                                                    <script>putplanet("{{t_planetid}}","{{t_planetname}}","{{t_g}}","{{t_s}}","{{t_p}}",{{t_relation}});</script>
                                                </div>
                                                <div class="col-auto">
                                                    <span class="text-yellow"><script>putcountdown1({{time}}, 'Arrivé', '?id={{fleetid}}')</script></span>
                                                </div>
                                            {% endif %}
                                            {% if waiting %}
                                                <div class="col-auto">
                                                    <span class="text-normal">En attente</span>
                                                </div>
                                                <div class="col-auto">
                                                    <span class="text-yellow"><script>putcountdown1({{time }}, 'Terminé', '?id={{fleetid}}')</script></span>
                                                </div>
                                            {% endif %}
                                        </div>
                                        {% if actions %}
                                            <ul class="mt-1 mb-0">
                                                {% for action in actions %}
                                                    <li>
                                                        {% if action.move %}
                                                            <span class="text-normal pe-3">Aller vers</span> <script>putplanet("{{planetid}}","{{planetname}}","{{g}}","{{s}}","{{p}}",{{relation}});</script>
                                                        {% endif %}
                                                        {% if action.loadall %}<span class="text-normal">Tout charger<span>{% endif %}
                                                        {% if action.unloadall %}<span class="text-normal">Tout décharger<span>{% endif %}
                                                        {% if action.recycle %}<span class="text-normal">Récolter les ressources<span>{% endif %}
                                                        {% if action.invade %}<span class="text-normal">Envahir<span>{% endif %}
                                                        {% if action.waiting %}<span class="text-normal">Attendre<span>{% endif %}
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                    </div>
                                    {% if warp %}
                                        <div class="col-auto">
                                            <a href="?id={{ fleetid }}&action=warp">Emprunter le vortex</a>
                                        </div>
                                    {% endif %}
                                    {% if waiting %}
                                        <div class="col-auto">
                                            <a href="?id={{ fleetid }}&action=stopwaiting">Stopper</a>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Attitude</span>
                            </div>
                            <div class="col-9">
                                <div class="row gx-3 align-items-center">
                                    <div class="col">
                                        {% if attack %}
                                            <img src="{{ PATH_IMAGES }}img/interface/stance_attack.gif"
                                                 class="me-1 stance"
                                                 data-bs-toggle="tooltip"
                                                 data-bs-title="Mode attaque"
                                                 width="10px"
                                                 height="10px">
                                            <span>Mode attaque</span>
                                        {% else %}
                                            <img src="{{ PATH_IMAGES }}img/interface/stance_defend.gif"
                                                 class="me-1 stance"
                                                 data-bs-toggle="tooltip"
                                                 data-bs-title="Mode riposte"
                                                 width="10px"
                                                 height="10px">
                                            <span>Mode riposte</span>
                                        {% endif %}
                                    </div>
                                    <div class="col-auto">
                                        {% if setstance %}
                                            <a href="?id={{ fleetid }}&action={% if setstance_attack %}attack{% endif %}{% if setstance_defend %}defend{% endif %}">
                                                {% if setstance_attack %}Attaquer{% endif %}
                                                {% if setstance_defend %}Riposter{% endif %}
                                            </a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="commandersbox" class="hidden">
                        <form action='?id={{ fleetid }}' method='post' class="row gx-2">
                            {% csrf_token %}
                            <input type='hidden' name='action' value='assigncommander'>
                            <div class="col">
                                <select class="form-control" name='commander'>
                                    {% if unassigncommander %}
                                        <option value='0'>
                                            Aucun
                                        </option>
                                    {% endif %}
                                    {% if nocommander %}
                                        <option value='0'>
                                            Aucun
                                        </option>
                                    {% endif %}
                                    {% for optgroup in optgroups %}
                                        <optgroup label='{% if optgroup.fleet %}sur Flottes{% endif %}{% if optgroup.planet %}sur Planètes{% endif %}{% if optgroup.none %}Non affectés{% endif %}'>
                                            {% for cmd_option in optgroup.cmd_options %}
                                                <option value={{ cmd_option.cmd_id }}{% if cmd_option.selected %} selected{% endif %}>&middot;&nbsp;{{ cmd_option.cmd_name }}
                                                    {% if cmd_option.assigned %}({{ cmd_option.name }}){% endif %}
                                                    {% if cmd_option.unavailable %}(Indisponible){% endif %}
                                                </option>
                                            {% endfor %}
                                        </optgroup>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-auto">
                                <input type="submit" class="btn btn-primary" value='OK'>
                            </div>
                            <div class="col-auto">
                                <button type="button" onclick="hide();" class="btn btn-danger">
                                    <i class="fa-fw fas fa-times" aria-hidden="true"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Commandement</span>
                            </div>
                            <div id="cmdref" class="col-9">
                                <div class="row gx-3 align-items-center">
                                    <div class="col-auto">
                                        {{ fleet_leadership|intcomma }} <small class="text-normal">/{{ fleet_size|intcomma }}</small>
                                        <small class="ms-3 text-normal">efficacité</small> {{ fleet_commander_efficiency }}%
                                    </div>
                                    <div class="col">
                                        {% if commander %}<i class="fa-fw fas fa-user-astronaut"></i> {{ commandername }}{% endif %}
                                    </div>
                                    <div class="col-auto">
                                        <a href="#" onclick="return show('cmdref','commandersbox')">Changer</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if not hide_recycling %}
                        <div class="col-12">
                            <div class="row gx-3 align-items-center">
                                <div class="col-3">
                                    <span class="text-normal">Recyclage</span>
                                </div>
                                <div class="col-9">
                                    <div class="row gx-3 align-items-center">
                                        <div class="col">
                                            {{ recycler_output|intcomma }} <span class="text-normal">unités /heure</span>
                                        </div>
                                        <div class="col-auto">
                                            {% if recycle %}<a href="?id={{ fleetid }}&action=recycle">Recycler</a>{% endif %}
                                            {% if recycling %}<a href="?id={{ fleetid }}&action=stoprecycling">Stopper</a>{% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    {% if invade %}
                        <div id="invadebox" class="hidden">
                            <form action="?id={{ fleetid }}"
                                  method="post"
                                  class="row gx-2 align-items-center">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="invade">
                                <div class="col-auto">
                                    <span class="text-normal">Envahir avec</span>
                                </div>
                                <div class="col-auto">
                                    <input id="droppods"
                                           min="1"
                                           type="number"
                                           name="droppods"
                                           size="6"
                                           maxlength="6"
                                           align="right"
                                           class="form-control"
                                           value="{{ fleet_droppods }}">
                                </div>
                                <div class="col-auto">
                                    <span class="text-normal">soldats</span>
                                </div>
                                {% if can_take %}
                                    <div class="col-auto">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="take" name="take">
                                            <label class="form-check-label" for="take">
                                                Occuper planète
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <img src="{{ PATH_IMAGES }}img/interface/prestige.gif"
                                             title="Prestige"
                                             class="res"
                                             width="16px"
                                             height="16px">
                                        {{ prestige }}
                                    </div>
                                {% endif %}
                                <div class="col-auto">
                                    <input type="submit" class="btn btn-primary" value='OK'>
                                </div>
                                <div class="col-auto">
                                    <button type="button" onclick="hide();" class="btn btn-danger">
                                        <i class="fa-fw fas fa-times" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    {% endif %}
                    {% if not hide_droppods %}
                        <div class="col-12">
                            <div class="row gx-3 align-items-center">
                                <div class="col-3">
                                    <span class="text-normal">Barges d'invasion</span>
                                </div>
                                <div id="invaderef" class="col-9">
                                    <div class="row gx-3 align-items-center">
                                        <div class="col">
                                            {{ fleet_droppods|intcomma }} <span class="text-normal">soldats</span>
                                        </div>
                                        {% if invade %}
                                            <div class="col-auto">
                                                <script>putcountdown2({{invade_time}},"Invasion possible dans ", '<a href="#" onclick=\'return show("invaderef","invadebox")\'>Envahir</a>');putcountdown1({{invade_time}},"","#")</script>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Saut intergalactique</span>
                            </div>
                            <div class="col-9">
                                <span class="text-normal">signature max</span> <span class="{% if insufficient_long_distance_capacity %}text-danger{% endif %}">{{ fleet_long_distance_capacity|intcomma }}</span> <span class="ms-3 text-normal">stabilité requise</span> {{ fleet_required_vortex_strength|intcomma }}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Signature</span>
                            </div>
                            <div class="col-9">
                                {{ fleet_real_signature|intcomma }} <span class="ms-3 text-normal">détectée</span> {{ fleet_signature|intcomma }}
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Entretien</span>
                            </div>
                            <div class="col-9">
                                <img src="{{ PATH_IMAGES }}img/interface/credits.gif"
                                     title="Credits"
                                     class="res"
                                     width="16px"
                                     height="16px">
                                {{ fleet_upkeep|intcomma }} <span class="ms-3 text-normal">x{{ fleet_upkeep_multiplicator }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Vitesse</span>
                            </div>
                            <div class="col-9">
                                <div class="row gx-3 align-items-center">
                                    <div class="col">
                                        {{ fleet_speed|intcomma }}
                                    </div>
                                    {% if cancel_moving %}
                                        <div class="col-auto">
                                            <span class="text-normal">Perte du contact</span> <span class="text-yellow"><script>putcountdown1({{timelimit}},"Effective"," ");</script></span> <script>putcountdown2({{timelimit}},'<a href="?id={{fleetid}}&action=return">Annuler</a>', '');</script>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="row gx-3 align-items-center">
                            <div class="col-3">
                                <span class="text-normal">Partage</span>
                            </div>
                            <div class="col-9">
                                <div class="row gx-3 align-items-center">
                                    <div class="col">
                                        Flotte partagée à l'alliance
                                        <a href="?id={{ fleetid }}&action=share">
                                            {% if shared %}Oui{% endif %}
                                            {% if not_shared %}Non{% endif %}
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if not hide_cargo %}
                        <div class="col-12">
                            <div class="row gx-3 align-items-center">
                                <div class="col-3">
                                    <span class="text-normal">Cargaison</span>
                                </div>
                                <div class="col-9">
                                    <span id="load">{{ fleet_load|intcomma }}</span> <small class="text-normal">/{{ fleet_capacity|intcomma }} unités</small>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    {% if error_trade %}
                        <div class="list-group-item text-center">
                            <span class="text-danger">
                                Impossible de marchander avec cette planète, ils n'ont pas les crédits pour acheter nos ressources.
                            </span>
                        </div>
                    {% endif %}
                    {% if error_recycling %}
                        <div class="text-danger text-center">
                            Une de nos flottes est déjà en train de recycler dans les parages !
                        </div>
                    {% endif %}
                    {% if error_soldiers %}
                        <div class="text-danger text-center">
                            Nombre de soldat incorrect !
                        </div>
                    {% endif %}
                    {% if error_fleet %}
                        <div class="text-danger text-center">
                            La flotte n'est pas prête pour une invasion !
                        </div>
                    {% endif %}
                    {% if error_planet %}
                        <div class="text-danger text-center">
                            Impossible d'envahir une planète inoccupée, alliée ou dans une alliance qui n'est pas en guerre contre nous !
                        </div>
                    {% endif %}
                    {% if error_max_planets_reached %}
                        <div class="text-danger text-center">
                            Nombre maximal de colonisations atteint !
                        </div>
                    {% endif %}
                    {% if error_invade_enemy_ships %}
                        <div class="text-danger text-center">
                            Impossible d'envahir tant que des vaisseaux militaires ennemis sont proches de la planète !
                        </div>
                    {% endif %}
                    {% if error_deploy_enemy_ships %}
                        <div class="text-danger text-center">
                            Impossible de coloniser tant que des vaisseaux militaires ennemis sont proches de la planète !
                        </div>
                    {% endif %}
                    {% if error_deploy_safe_planets %}
                        <div class="text-danger text-center">
                            Impossible de coloniser plus de planètes dans des galaxies protégées !
                        </div>
                    {% endif %}
                </div>
            </div>
            </div>
            {% if move_fleet %}
                <script>
                var tab = new Array();

                function fillDest(obj) {
                
                    var dest = obj.selectedIndex;
                    setval("g",tab[dest][0]);
                    setval("s",tab[dest][1]);
                    setval("p",tab[dest][2]);	
                }
                
                function d(idx, name, g, s, p) { tab[idx] = new Array(g, s, p); }
                
                {% if planetgroup %}
                    {% for location in planetgroup %}d({{location.index}},'{{location.name}}',{{location.to_g}},{{location.to_s}},{{location.to_p}});{% endfor %}
                {% endif %}

                {% if fleetgroup %}
                    {% for location in fleetgroup %}d({{location.index}},'{{location.name}}',{{location.to_g}},{{location.to_s}},{{location.to_p}});{% endfor %}
                {% endif %}

                {% if merchantplanetsgroup %}
                    {% for location in merchantplanetsgroup %}d({{location.index}},'',{{location.to_g}},{{location.to_s}},{{location.to_p}});{% endfor %}
                {% endif %}

                function setTravelTime(seconds)
                {
                    var traveleta_obj = document.getElementById("travel_eta");
                    var traveltime_obj = document.getElementById("travel_time");

                    if(seconds < 0)
                    {
                        var s = "<span class='text-danger'>Saut impossible</span>";
                        if(traveltime_obj.innerHTML != s) traveltime_obj.innerHTML = s;

                        traveleta_obj.innerHTML = "";
                    }
                    else
                    {
                        var s = formattime(seconds);
                        if(traveltime_obj.innerHTML != s) traveltime_obj.innerHTML = s;
                    }
                }

                function updatetravel() {
                    window.setTimeout("updatetravel()", 100);
                    var to_g = getval("g");

                    if(to_g < 0){ to_g = 1; setval("g", 1); }

                    var to_s = getval("s");

                    if(to_s < 0){ to_s = 1; setval("s", 1); }
                    if(to_s > 99){ to_s = 99; setval("s", 99); }

                    var to_p = getval("p");

                    if(to_p < 0){ to_p = 1; setval("p", 1); }
                    if(to_p > 25){ to_p = 25; setval("p", 25); }


                    var oTravelCost = document.getElementById("travel_cost");

                    var cost = 0;
                    var distance = 0;
                    var time = 0;

                    if({{g}} != to_g) {
                        if({{fleet_real_signature}} > {{fleet_long_distance_capacity}}) {
                            var s = "-";
                            if(oTravelCost.innerHTML != s) oTravelCost.innerHTML = s;

                            setTravelTime(-1);

                            return;
                        }

                        distance = 200;
                        time = {{fleet_required_vortex_strength}}*24*3600;
                    }
                    else {
                        if({{s}} != to_s)
                            distance = 6*Math.sqrt( Math.pow(Math.floor((to_s-1) / 10) - Math.floor(({{s}}-1)/10), 2) + Math.pow((to_s-1) % 10 - ({{s}}-1)%10, 2) );
                        else
                        if({{p}} != to_p)
                            distance = Math.sqrt( Math.pow(Math.floor((to_p-1) / 5) - Math.floor(({{p}}-1)/5), 2) + Math.pow((to_p-1) % 5 - ({{p}}-1)%5, 2) );

                        time = Math.floor(distance * (1000.0/{{fleet_speed}}) * 3600);
                    }
                    
                    cost = Math.floor(distance / 200.0 * {{fleet_real_signature}});

                    setTravelTime(time);

                    if(distance > 0 && cost == 0) cost = 1;
                    if(oTravelCost.innerHTML != cost) oTravelCost.innerHTML = formatnumber(cost);
                }
                </script>
                <form method="post" action="?id={{ fleetid }}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="move">
                    <input type="hidden" name="loop" value="0">
                    <div class="mt-3 card">
                        <div class="card-header">
                            <span class="fs-6">Déplacer la flotte</span>
                        </div>
                        <div class="card-body">
                            <div class="row g-1 flex-column">
                                <div class="col-12">
                                    <div class="row gx-3 align-items-center">
                                        <div class="col-3">
                                            <span class="text-normal">Action</span>
                                        </div>
                                        <div class="col">
                                            <select class="form-control" name="movetype">
                                                <option value="0">
                                                    Aller simple
                                                </option>
                                                <option value="1">
                                                    Aller décharger puis revenir
                                                </option>
                                                <option value="2">
                                                    Aller recycler puis revenir
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="row gx-3 align-items-center">
                                        <div class="col-3">
                                            <span class="text-normal">Destination</span>
                                        </div>
                                        <div class="col">
                                            <div class="row gx-2 align-items-center">
                                                <div class="col-auto">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="1"
                                                           name="g"
                                                           size="3"
                                                           maxlength="2"
                                                           value="{{g}}">
                                                </div>
                                                <div class="col-auto">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="1"
                                                           name="s"
                                                           size="3"
                                                           maxlength="2"
                                                           value="{{s}}">
                                                </div>
                                                <div class="col-auto">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="1"
                                                           name="p"
                                                           size="3"
                                                           maxlength="2"
                                                           value="{{p}}">
                                                </div>
                                                <div class="col">
                                                    <select class="form-control"
                                                            name="planetlist"
                                                            tabindex="1"
                                                            onchange="fillDest(this)">
                                                        {% if planetgroup %}
                                                            <optgroup label="Planètes">
                                                                {% for location in planetgroup %}
                                                                    <option{% if location.selected %} selected{% endif %}>
                                                                        {{ location.name }} ({{ location.to_g }}.{{ location.to_s }}.{{ location.to_p }})
                                                                    </option>
                                                                {% endfor %}
                                                            </optgroup>
                                                        {% endif %}
                                                        {% if fleetgroup %}
                                                            <optgroup label="Vers Flottes">
                                                                {% for location in fleetgroup %}
                                                                    <option{% if location.selected %} selected{% endif %}>
                                                                        {{ location.fleet_name }} ({{ location.to_g }}.{{ location.to_s }}.{{ location.to_p }})
                                                                    </option>
                                                                {% endfor %}
                                                            </optgroup>
                                                        {% endif %}
                                                        {% if merchantplanetsgroup %}
                                                            <optgroup label="Planètes marchandes">
                                                                {% for location in merchantplanetsgroup %}
                                                                    <option{% if location.selected %} selected{% endif %}>
                                                                        Marchand ({{ location.to_g }}.{{ location.to_s }}.{{ location.to_p }})
                                                                    </option>
                                                                {% endfor %}
                                                            </optgroup>
                                                        {% endif %}
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-3 col-12">
                                    <div class="row gx-3 align-items-center justify-content-end">
                                        <div class="col-auto">
                                            <span class="text-normal me-2">Durée</span>
                                            <span id="travel_time">-</span>
                                        </div>
                                        <div class="col-auto">
                                            <span class="text-normal me-2">Coût</span>
                                            <img src="{{ PATH_IMAGES }}img/interface/credits.gif"
                                                 class="res"
                                                 data-bs-toggle="tooltip"
                                                 data-bs-title="Crédits"
                                                 width="16px"
                                                 height="16px">
                                            <span id="travel_cost">0</span>
                                        </div>
                                        <div class="col-auto">
                                            <input type="submit" class="btn btn-primary" value="Envoyer">
                                        </div>
                                    </div>
                                </div>
                                {% if result %}
                                    <div class="col-12">
                                        <span class="text-danger">
                                            {% if ok %}Flotte envoyée{% endif %}
                                            {% if bad_destination %}Destination non valide{% endif %}
                                            {% if new_player_protection %}Planète temporairement protégée{% endif %}
                                            {% if long_travel_impossible %}Saut impossible{% endif %}
                                            {% if not_enough_credits %}Pas assez de crédits{% endif %}
                                            {% if error_jump_from_require_empty_location %}
                                                Impossible de sauter d'ici. Déplacez la flotte à proximité d'un vortex avant de sauter.
                                            {% endif %}
                                            {% if error_jump_protected_galaxy %}Galaxie protégée{% endif %}
                                            {% if error_jump_to_require_empty_location %}
                                                Impossible de sauter vers cette destination. Choisissez un vortex comme point d'arrivé.
                                            {% endif %}
                                            {% if error_jump_to_same_point_limit_reached %}
                                                Trop de flottes sautent vers la même destination, utilisez des vortex avec stabilité suffisante.
                                            {% endif %}
                                        </span>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </form>
                <script>window.setTimeout("updatetravel()", 500);</script>
            {% endif %}
            {% if not hide_cargo %}
                <div class="mt-3" id="cargobox">
                    <script>
                function load_all(o,h,s,so,w) {
                
                    setval('load_ore',o);
                    setval('load_hydrocarbon',h);
                    setval('load_scientists',s);
                    setval('load_soldiers',so);
                    setval('load_workers',w);
                    return false;
                }

                function unload_all(o,h,s,so,w) {
                
                    setval('unload_ore',o);
                    setval('unload_hydrocarbon',h);
                    setval('unload_scientists',s);
                    setval('unload_soldiers',so);
                    setval('unload_workers',w);
                    return false;
                }
                {% if unload %}
                    showUnload({{ fleet_ore }},{{ fleet_hydrocarbon }},{{ fleet_scientists }},{{ fleet_soldiers }},{{ fleet_workers }},0
                    {% if canload %}1{% endif %}
                    );
                {% endif %}
                    </script>
                    {% if cargo %}
                        <div class="card">
                            <div class="card-header">
                                <span class="fs-6">Cargaison</span>
                                <span class="ms-2 text-normal">Aucune action possible</span>
                            </div>
                            <div class="card-body">
                                <div class="row gx-3 gy-1 align-items-center justify-content-center">
                                    {% if fleet_load <= 0 %}
                                        <div class="col-auto">
                                            <span class="text-normal">Vide</span>
                                        </div>
                                    {% else %}
                                        {% if fleet_ore > 0 %}
                                            <div class="col-auto">
                                                <img src="{{ PATH_IMAGES }}img/interface/ore.gif"
                                                     data-bs-toggle="tooltip"
                                                     data-bs-title="Minerai"
                                                     class="res"
                                                     width="16px"
                                                     height="16px"/>
                                                {{ fleet_ore|intcomma }}
                                            </div>
                                        {% endif %}
                                        {% if fleet_hydrocarbon > 0 %}
                                            <div class="col-auto">
                                                <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif"
                                                     data-bs-toggle="tooltip"
                                                     data-bs-title="Hydrocarbure"
                                                     class="res"
                                                     width="16px"
                                                     height="16px"/>
                                                {{ fleet_hydrocarbon|intcomma }}
                                            </div>
                                        {% endif %}
                                        {% if fleet_scientists > 0 %}
                                            <div class="col-auto">
                                                <img src="{{ PATH_IMAGES }}img/interface/scientists.gif"
                                                     data-bs-toggle="tooltip"
                                                     data-bs-title="Scientifiques"
                                                     class="res"
                                                     width="16px"
                                                     height="16px"/>
                                                {{ fleet_scientists|intcomma }}
                                            </div>
                                        {% endif %}
                                        {% if fleet_soldiers > 0 %}
                                            <div class="col-auto">
                                                <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif"
                                                     data-bs-toggle="tooltip"
                                                     data-bs-title="Soldats"
                                                     class="res"
                                                     width="16px"
                                                     height="16px"/>
                                                {{ fleet_soldiers|intcomma }}
                                            </div>
                                        {% endif %}
                                        {% if fleet_workers > 0 %}
                                            <div class="col-auto">
                                                <img src="{{ PATH_IMAGES }}img/interface/workers.gif"
                                                     data-bs-toggle="tooltip"
                                                     data-bs-title="Travailleurs"
                                                     class="res"
                                                     width="16px"
                                                     height="16px"/>
                                                {{ fleet_workers|intcomma }}
                                            </div>
                                        {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% elif load %}
                        <form method="post" action="/s03/fleet-trade/?id={{ fleetid }}">
                            {% csrf_token %}
                            <div class="card">
                                <div class="card-header">
                                    <span class="fs-6">Cargaison</span>
                                    <span class="ms-2 text-normal">Chargement et déchargement possible</span>
                                </div>
                                <div class="card-body">
                                    <div class="row g-1 flex-column">
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col-auto text-end" style="width:247px;">
                                                    <span class="text-normal">En soute</span>
                                                </div>
                                                <div class="col-auto text-end" style="width:253px;">
                                                    <span class="text-normal">Sur la planète</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/ore.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Minerai"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Minerai</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_ore|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_ore"
                                                           id="unload_ore"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#" class="ms-2" onclick="setval('unload_ore', {{ fleet_ore }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_ore|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_ore"
                                                           id="load_ore"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#" class="ms-2" onclick="setval('load_ore', {{ planet_ore }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Hydrocarbure"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Hydrocarbure</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_hydrocarbon|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_hydrocarbon"
                                                           id="unload_hydrocarbon"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_hydrocarbon', {{ fleet_hydrocarbon }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_hydrocarbon|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_hydrocarbon"
                                                           id="load_hydrocarbon"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_hydrocarbon', {{ planet_hydrocarbon }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/scientists.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Scientifiques"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Scientifiques</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_scientists|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_scientists"
                                                           id="unload_scientists"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_scientists', {{ fleet_scientists }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_scientists|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_scientists"
                                                           id="load_scientists"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_scientists', {{ planet_scientists }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Soldats"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Soldats</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_soldiers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_soldiers"
                                                           id="unload_soldiers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_soldiers', {{ fleet_soldiers }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_soldiers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_soldiers"
                                                           id="load_soldiers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_soldiers', {{ planet_soldiers }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/workers.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Travailleurs"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Travailleurs</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_workers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_workers"
                                                           id="unload_workers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_workers', {{ fleet_workers }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_workers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_workers"
                                                           id="load_workers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_workers', {{ planet_workers }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12 mt-3">
                                            <div class="row gx-3 align-items-center justify-content-end">
                                                <div class="col-auto">
                                                    <a href="#"
                                                       onclick="return unload_all({{ fleet_ore }}, {{ fleet_hydrocarbon }}, {{ fleet_scientists }}, {{ fleet_soldiers }}, {{ fleet_workers }})">Tout décharger</a>
                                                </div>
                                                <div class="col-auto">
                                                    <a href="#"
                                                       onclick="return load_all({{ planet_ore }}, {{ planet_hydrocarbon }}, {{ planet_scientists }}, {{ planet_soldiers }}, {{ planet_workers }})">Tout charger</a>
                                                </div>
                                                <div class="col-auto">
                                                    <input type="submit" class="btn btn-primary" value="Transférer">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    {% elif unload %}
                        <form method="post" action="/s03/fleet-trade/?id={{ fleetid }}">
                            {% csrf_token %}
                            <div class="card">
                                <div class="card-header">
                                    <span class="fs-6">Cargaison</span>
                                    <span class="ms-2 text-normal">Déchargement uniquement possible</span>
                                </div>
                                <div class="card-body">
                                    <div class="row g-1 flex-column">
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col-auto text-end" style="width:247px;">
                                                    <span class="text-normal">En soute</span>
                                                </div>
                                                <div class="col-auto text-end" style="width:253px;">
                                                    <span class="text-normal">Sur la planète</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/ore.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Minerai"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Minerai</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_ore|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_ore"
                                                           id="unload_ore"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#" class="ms-2" onclick="setval('unload_ore', {{ fleet_ore }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_ore|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_ore"
                                                           id="load_ore"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#" class="ms-2" onclick="setval('load_ore', {{ planet_ore }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Hydrocarbure"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Hydrocarbure</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_hydrocarbon|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_hydrocarbon"
                                                           id="unload_hydrocarbon"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_hydrocarbon', {{ fleet_hydrocarbon }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_hydrocarbon|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_hydrocarbon"
                                                           id="load_hydrocarbon"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_hydrocarbon', {{ planet_hydrocarbon }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/scientists.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Scientifiques"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Scientifiques</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_scientists|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_scientists"
                                                           id="unload_scientists"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_scientists', {{ fleet_scientists }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_scientists|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_scientists"
                                                           id="load_scientists"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_scientists', {{ planet_scientists }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Soldats"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Soldats</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_soldiers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_soldiers"
                                                           id="unload_soldiers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_soldiers', {{ fleet_soldiers }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_soldiers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_soldiers"
                                                           id="load_soldiers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_soldiers', {{ planet_soldiers }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="row gx-3 align-items-center">
                                                <div class="col">
                                                    <img src="{{ PATH_IMAGES }}img/interface/workers.gif"
                                                         data-bs-toggle="tooltip"
                                                         data-bs-title="Travailleurs"
                                                         class="res"
                                                         width="16px"
                                                         height="16px"/>
                                                    <span class="text-normal">Travailleurs</span>
                                                </div>
                                                <div class="col-2 text-end">
                                                    {{ fleet_workers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="unload_workers"
                                                           id="unload_workers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('unload_workers', {{ fleet_workers }})">max</a>
                                                </div>
                                                <div class="col-3 text-end">
                                                    {{ planet_workers|intcomma }}
                                                </div>
                                                <div class="col-auto d-flex align-items-center">
                                                    <input type="number"
                                                           class="form-control"
                                                           min="0"
                                                           name="load_workers"
                                                           id="load_workers"
                                                           value="0"
                                                           size="6"/>
                                                    <a href="#"
                                                       class="ms-2"
                                                       onclick="setval('load_workers', {{ planet_workers }})">max</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12 mt-3">
                                            <div class="row gx-3 align-items-center justify-content-end">
                                                <div class="col-auto">
                                                    <a href="#"
                                                       onclick="return unload_all({{ fleet_ore }}, {{ fleet_hydrocarbon }}, {{ fleet_scientists }}, {{ fleet_soldiers }}, {{ fleet_workers }})">Tout décharger</a>
                                                </div>
                                                <div class="col-auto">
                                                    <a href="#"
                                                       onclick="return load_all({{ planet_ore }}, {{ planet_hydrocarbon }}, {{ planet_scientists }}, {{ planet_soldiers }}, {{ planet_workers }})">Tout charger</a>
                                                </div>
                                                <div class="col-auto">
                                                    <input type="submit" class="btn btn-primary" value="Transférer">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    {% endif %}
                </div>
            {% endif %}
        </div>
        <div class="col-4">
            <div class="card">
                <div class="card-header">
                    <div class="row gx-3">
                        <div class="col">
                            <span class="fs-6">Vaisseaux</span>
                        </div>
                        {% if manage %}
                            <div class="col-auto">
                                <a href="/s03/fleet-ships/?id={{ fleetid }}">Gérer</a>
                            </div>
                        {% endif %}
                        {% if split %}
                            <div class="col-auto">
                                <a href="/s03/fleet-split/?id={{ fleetid }}">Scinder</a>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                <div class="row gy-2 flex-column">
                    {% for ship in shiplist %}
                        <div class="col-12">
                            <div class="row gx-3">
                                <div class="col-auto pe-0">
                                    <span class="text-normal"><i class="fa-fw fas fa-question-circle" data-bs-toggle="tooltip" data-bs-html="true" data-bs-title="
                                        <div class='mb-1'><span class='fs-6'>Description</span></div>
                                        <div class='mb-3'><span class='text-normal'>{{ ship.description|escape }}</span></div>
                                        <div class='mb-1'><span class='fs-6'>Caractéristiques</span></div>
                                        <div class='row gx-3 gy-1'>
                                            <div class='col-auto'>
                                                <small class='text-normal'>Signature</small>
                                                <span class='text-white'>{{ ship.ship_signature|intcomma }}</span>
                                            </div>
                                            {% if ship.ship_cargo > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Cargo</small>
                                                    <span class='text-white'>{{ ship.ship_cargo|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            <div class='col-auto'>
                                                <small class='text-normal'>Vitesse</small>
                                                <span class='text-white'>{{ ship.ship_speed|intcomma }}</span>
                                            </div>
                                            <div class='col-auto'>
                                                <small class='text-normal'>Manœuvrabilité</small>
                                                <span class='text-white'>{{ ship.ship_handling|intcomma }}</span>
                                            </div>
                                            {% if ship.ship_leadership > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Commandement</small>
                                                    <span class='text-white'>{{ ship.ship_leadership|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            <div class='col-auto'>
                                                <small class='text-normal'>Armure</small>
                                                <span class='text-white'>{{ ship.ship_hull|intcomma }}</span>
                                            </div>
                                            {% if ship.ship_turrets > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Dommage</small>
                                                    <span class='text-white'>{{ ship.ship_turrets|intcomma }} <small class='text-normal'>x</small> {{ ship.ship_power|intcomma }}</span>
                                                </div>
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Ciblage</small>
                                                    <span class='text-white'>{{ ship.ship_tracking_speed|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            {% if ship.ship_shield > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Bouclier</small>
                                                    <span class='text-white'>{{ ship.ship_shield|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            {% if ship.ship_recycler_output > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Recyclage</small>
                                                    <span class='text-white'>{{ ship.ship_recycler_output|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            {% if ship.ship_long_distance_capacity > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Saut</small>
                                                    <span class='text-white'>{{ ship.ship_long_distance_capacity|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                            {% if ship.ship_droppods > 0 %}
                                                <div class='col-auto'>
                                                    <small class='text-normal'>Invasion</small>
                                                    <span class='text-white'>{{ ship.ship_droppods|intcomma }}</span>
                                                </div>
                                            {% endif %}
                                        </div>
                                    "></i></span>
                                </div>
                                <div class="col">
                                    <a href="/s03/help/?cat=ships#{{ ship.id }}"
                                       data-bs-toggle="tooltip"
                                       data-bs-title="Voir aide">{{ ship.name }}</a>
                                    <small class="mx-1 text-normal">x</small>
                                    {{ ship.quantity|intcomma }}
                                </div>
                                {% if ship.install %}
                                    <div class="col-auto">
                                        <a href="?id={{ fleetid }}&action=install&s={{ ship.id }}">Déployer</a>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
                </div>
            </div>
            {% if fleets|length > 0 %}
                <div class="mt-3 card">
                    <div class="card-header">
                        <span class="fs-6">Autres flottes</span>
                    </div>
                    <div class="card-body">
                    <div class="row gy-2 flex-column">
                        {% for fleet in fleets %}
                            <div class="col-12">
                                <div class="row gx-3">
                                    {% if fleet.playerfleet %}
                                        <div class="col-auto pe-0">
                                            <span class="text-normal"><i class="fa-fw fas fa-question-circle" data-bs-toggle="tooltip" data-bs-html="true" data-bs-title="
                                                <div class='row g-1 flex-column'>
                                                    <div class='col-12'>
                                                        <div class='row gx-3'>
                                                            <div class='col'>
                                                                <span class='text-normal'>Signature</span>
                                                            </div>
                                                            <div class='col-auto'>
                                                                <span>{{ fleet.signature|intcomma }}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class='col-12'>
                                                        <div class='row gx-3'>
                                                            <div class='col'>
                                                                <span class='text-normal'>Vitesse</span>
                                                            </div>
                                                            <div class='col-auto'>
                                                                <span>{{ fleet.speed|intcomma }}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class='col-12'>
                                                        <div class='row gx-3'>
                                                            <div class='col'>
                                                                <span class='text-normal'>Cargo</span>
                                                            </div>
                                                            <div class='col-auto'>
                                                                <span>{{ fleet.cargo_load|intcomma }}</span> <small class='text-normal'>/{{ fleet.cargo_capacity|intcomma }}</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            "></i></span>
                                        </div>
                                        <div class="col">
                                            <a href="?id={{ fleet.id }}" class="self" data-bs-toggle="tooltip" data-bs-html="true" data-bs-title="Voir flotte">{{ fleet.name }}</a>
                                            <small class="ms-2">{{ fleet.signature|intcomma }}</small>
                                        </div>
                                        {% if fleet.merge %}
                                            <div class="col-auto">
                                                <a href="?id={{ fleetid }}&action=merge&with={{ fleet.id }}">Absorber</a>
                                            </div>
                                        {% endif %}
                                    {% else %}
                                        <div class="col">
                                            <a href="/s03/mails/?subject=À propos de la flotte {{ fleet.name }}&to={{ fleet.owner }}"
                                               data-bs-toggle="tooltip"
                                               data-bs-title="Contacter {{ fleet.owner }}"
                                               class="{% if fleet.ally %}text-success{% endif %}{% if fleet.friend %}friend{% endif %}{% if fleet.enemy %}enemy{% endif %}">
                                                {% if fleet.alliance %}[{{ fleet.tag }}]{% endif %}
                                                {{ fleet.name }}
                                            </a>
                                            <small class="ms-2">{{ fleet.signature|intcomma }}</small>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
