{% extends "s03/layout.html" %}
{% load humanize %}
{% block content %}
<div class="page-content">
    <ul class="nav nav-tabs mt-0 mb-3">
        <li class="nav-item">
            <a href="/s03/planet/?planet={{ cur_planetid }}" class="nav-link">Aperçu</a>
        </li>
        <li class="nav-item">
            <a href="/s03/production/?planet={{ cur_planetid }}" class="nav-link">Production</a>
        </li>
        <li class="nav-item">
            <a href="/s03/production/?planet={{ cur_planetid }}&cat=2" class="nav-link">Fonctionnement</a>
        </li>
        <li class="nav-item">
            <a href="/s03/buildings/?planet={{ cur_planetid }}" class="nav-link">Bâtiments</a>
        </li>
        <li class="nav-item">
            <a href="/s03/shipyard/?planet={{ cur_planetid }}" class="nav-link">Vaisseaux</a>
        </li>
        <li class="nav-item">
            <a href="/s03/shipyard/?planet={{ cur_planetid }}&recycle=1" class="nav-link">Recyclage</a>
        </li>
        <li class="nav-item active">
            <a href="/s03/training/?planet={{ cur_planetid }}" class="nav-link">Entraînements</a>
        </li>
        <li class="nav-item">
            <a href="/s03/orbit/?planet={{ cur_planetid }}" class="nav-link">Orbite</a>
        </li>
        <li class="nav-item">
            <a href="/s03/market-sell/?planet={{ cur_planetid }}" class="nav-link">Vente</a>
        </li>
        <li class="nav-item">
            <a href="/s03/market-buy/?planet={{ cur_planetid }}" class="nav-link">Achat</a>
        </li>
        <li class="nav-item">
            <a href="/s03/production/?planet={{ cur_planetid }}&cat=3" class="nav-link">Transferts</a>
        </li>
    </ul>
</div>
<div class="scroll-content" style="height:calc(100% - 158px);">
<div class="page-content">
<script>
    function updateNeeds() {
    
        var sc = getval('scientists');
        var so = getval('soldiers');

        var ore = sc * {{prices.scientist_ore}} + so * {{prices.soldier_ore}};
        var hydro = sc * {{prices.scientist_hydrocarbon}} + so * {{prices.soldier_hydrocarbon}};
        var credits = sc * {{prices.scientist_credits}} + so * {{prices.soldier_credits}};

        $('totalore').innerHTML = formatnumber(ore);
        $('totalhydrocarbon').innerHTML = formatnumber(hydro);
        $('totalcredits').innerHTML = formatnumber(credits);
    }
</script>
{% if trainings %}
<div class="card mb-3">
    <div class="card-header">
        <span class="fs-6">En cours</span>
    </div>
    <div class="list-group list-group-flush">
        {% for item in trainings %}
            <div class="list-group-item bg-success">
                <div class="row gx-3 align-items-center">
                    <div class="col">
                        {% if item.scientists %}
                            <img src="{{ PATH_IMAGES }}img/interface/scientists.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Scientifique" />
                            <a href="/s03/help/#scientists" data-bs-toggle="tooltip" data-bs-title="Voir aide">Scientifiques</a>
                        {% endif %}
                        {% if item.soldiers %}
                            <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Soldat" />
                            <a href="/s03/help/#soldiers" data-bs-toggle="tooltip" data-bs-title="Voir aide">Soldats</a>
                        {% endif %}
                    </div>
                    <div class="col-auto">
                        <small class="text-normal">x</small>
                        {% if item.scientists %}{{ item.scientists|intcomma }}{% endif %}
                        {% if item.soldiers %}{{ item.soldiers|intcomma }}{% endif %}
                    </div>
                    <div class="col-auto">
                        <span class="text-yellow"><script>putcountdown1({{ item.remainingtime }}, "");</script></span>
                    </div>
                    <div class="col-auto">
                        <script>putcountdown2({{ item.remainingtime }}, "<a href='?planet={{cur_planetid}}&a=cancel&q={{item.id}}' class='text-danger' data-bs-toggle='tooltip' data-bs-title='Annuler'><i class='fa-fw fas fa-times'></i></a>", "<a href='/s03/training/'>Terminé</a>");</script>
                    </div>
                </div>
            </div>
        {% endfor %}
        {% for item in queues %}
            <div class="list-group-item">
                <div class="row gx-3 align-items-center">
                    <div class="col">
                        {% if item.scientists %}
                            <img src="{{ PATH_IMAGES }}img/interface/scientists.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Scientifique" />
                            <a href="/s03/help/#scientists" data-bs-toggle="tooltip" data-bs-title="Voir aide">Scientifiques</a>
                        {% endif %}
                        {% if item.soldiers %}
                            <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Soldat" />
                            <a href="/s03/help/#soldiers" data-bs-toggle="tooltip" data-bs-title="Voir aide">Soldats</a>
                        {% endif %}
                    </div>
                    <div class="col-auto">
                        <small class="text-normal">x</small>
                        {% if item.scientists %}{{ item.scientists|intcomma }}{% endif %}
                        {% if item.soldiers %}{{ item.soldiers|intcomma }}{% endif %}
                    </div>
                    <div class="col-auto">
                        {% if item.scientists %}<script>document.write(formattime({{item.scientists_remainingtime }}))</script>{% endif %}
                        {% if item.soldiers %}<script>document.write(formattime({{item.soldiers_remainingtime }}))</script>{% endif %}
                    </div>
                    <div class="col-auto">
                        <a href="?planet={{ cur_planetid }}&a=cancel&q={{ item.id }}" class="text-danger" data-bs-toggle="tooltip" data-bs-title="Annuler"><i class="fa-fw fas fa-times"></i></a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}
<form method="post" action="/s03/training/?a=train">
    {% csrf_token %}
    <div class="card mb-3">
        <div class="card-header">
            <span class="fs-6">Entraînements</span>
        </div>
        <div class="list-group list-group-flush">
            <div class="list-group-item">
                <div class="row gx-3 align-items-center">
                    <div class="col">
                        <img src="{{ PATH_IMAGES }}img/interface/scientists.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Scientifique" />
                        <a href="/s03/help/#scientists" data-bs-toggle="tooltip" data-bs-title="Voir aide">Scientifiques</a>
                    </div>
                    <div class="col-auto" style="width:200px;">
                        {{ planet.scientists|intcomma }}
                        <small class="text-normal">/{{ planet.scientists_capacity|intcomma }}</small>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/ore.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Minerai" />
                        <span>{{ prices.scientist_ore|intcomma }}</span>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Hydrocarbure" />
                        <span>{{ prices.scientist_hydrocarbon|intcomma }}</span>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/credits.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Crédit" />
                        <span>{{ prices.scientist_credits|intcomma }}</span>
                    </div>
                    <div class="col-auto text-end" style="width:110px;">
                        {% if planet.scientists < planet.scientists_capacity %}
                            <input type="number" class="form-control" style="max-width:100%;" min="0" name="scientists" onkeyup="updateNeeds()" size="5" maxlength="5" />
                        {% else %}
                            <span class="text-danger">Maximum atteint</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="list-group-item">
                <div class="row gx-3 align-items-center">
                    <div class="col">
                        <img src="{{ PATH_IMAGES }}img/interface/soldiers.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Soldat" />
                        <a href="/s03/help/#soldiers" data-bs-toggle="tooltip" data-bs-title="Voir aide">Soldats</a>
                    </div>
                    <div class="col-auto" style="width:200px;">
                        {{ planet.soldiers|intcomma }}
                        <small class="text-normal">/{{ planet.soldiers_capacity|intcomma }}</small>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/ore.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Minerai" />
                        <span>{{ prices.soldier_ore|intcomma }}</span>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Hydrocarbure" />
                        <span>{{ prices.soldier_hydrocarbon|intcomma }}</span>
                    </div>
                    <div class="col-auto" style="width:100px;">
                        <img src="{{ PATH_IMAGES }}img/interface/credits.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Credit" />
                        <span>{{ prices.soldier_credits|intcomma }}</span>
                    </div>
                    <div class="col-auto text-end" style="width:110px;">
                        {% if planet.soldiers < planet.soldiers_capacity %}
                            <input type="number" class="form-control" style="max-width:100%;" min="0" name="soldiers" onkeyup="updateNeeds()" size="5" maxlength="5" />
                        {% else %}
                            <span class="text-danger">Maximum atteint</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card card-body">
        <div class="row gx-3 align-items-center justify-content-end">
            <div class="col-auto" style="width:100px;">
                <img src="{{ PATH_IMAGES }}img/interface/ore.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Minerai" />
                <span id="totalore">0</span>
            </div>
            <div class="col-auto" style="width:100px;">
                <img src="{{ PATH_IMAGES }}img/interface/hydrocarbon.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Hydrocarbure" />
                <span id="totalhydrocarbon">0</span>
            </div>
            <div class="col-auto" style="width:100px;">
                <img src="{{ PATH_IMAGES }}img/interface/credits.gif" class="res" width="16px" height="16px" data-bs-toggle="tooltip" data-bs-title="Credit" />
                <span id="totalcredits">0</span>
            </div>
            <div class="col-auto" style="width:110px;">
                <input type="submit" class="w-100 btn btn-primary" value="Entraîner" />
            </div>
        </div>
    </div>
</form>
</div>
</div>
{% endblock %}
